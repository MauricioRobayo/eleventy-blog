{
  "version": "https://jsonfeed.org/version/1.1",
  "title": "Mauricio Robayo",
  "language": "en",
  "home_page_url": "https://blog.mauriciorobayo.com/",
  "feed_url": "https://blog.mauriciorobayo.com/feed/feed.json",
  "description": "A Simple blog",
  "author": {
    "name": "Mauricio Robayo",
    "url": "https://blog.mauriciorobayo.com/about-me/"
  },
  "items": [{
      "id": "https://blog.mauriciorobayo.com/posts/efortless-refactor-with-de-morgans-laws/",
      "url": "https://blog.mauriciorobayo.com/posts/efortless-refactor-with-de-morgans-laws/",
      "title": "Effortless refactor with De Morgan&#39;s Laws",
      "content_html": "<p>I recently learned about <a href=\"https://en.wikipedia.org/wiki/De_Morgan%27s_laws\">De Morgan's laws</a> by watching an informative video by the <a href=\"https://www.youtube.com/channel/UCgs-54tlVBF80MMD9_YqBng\">ProgramArtist</a> about code refactoring.</p>\n<p>In the video he quickly mentions De Morgan's laws to simplify a section of the code.</p>\n<p>De Morgan's laws are a pair of transformation rules used in Boolean logic. They state that we can reverse everything inside the parenthesis so we can remove the negation:</p>\n<pre><code>!(A &amp;&amp; B) === !A || !B\n!(A || B) === !A &amp;&amp; !B\n</code></pre>\n<p>In programming, reading a conditional that is wrap inside a negation adds another level of complexity, as we must understand the logic expression and then negate it.</p>\n<p>In the video, he is using a real piece of code that looks like this:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><br />  <span class=\"token operator\">!</span>exports<span class=\"token punctuation\">.</span>sqlTimingLogger<span class=\"token punctuation\">.</span><span class=\"token function\">isErrorEnabled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span><br />  <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>exports<span class=\"token punctuation\">.</span>DriverSpy<span class=\"token punctuation\">.</span>dumpSqlFilteringOn <span class=\"token operator\">||</span> <span class=\"token function\">shouldSqlBeLogged</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br /><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p>Ouch! Understanding that condition requires a lot of mental effort.</p>\n<p>Let's make it more general so it is easier to follow the process:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>conditionA <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>conditionB <span class=\"token operator\">||</span> conditionC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p>So, how can we simplify this by applying De Morgan's laws?</p>\n<p>First, we can remove the negation by reversing what's inside the parenthesis:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>conditionA <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>conditionB <span class=\"token operator\">||</span> conditionC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p>Now the outer negation is gone, but we have another inner negation to which we can also apply De Morgan's law:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>conditionA <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>conditionB <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>conditionC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">return</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p>This becomes easier to understand as we don't have to negate some inner logic. If we followed De Morgan's laws, we can be confident that our logic is the same, and we don't have to put our brains at work to decipher what's going on.</p>\n<p>What's more, now that we have removed any wrapping negations effortlessly but applying De Morgan's law, we can simplify this into separate if statements which will make this a breeze to understand:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>conditionA<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><br /><br /><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>conditionB <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>conditionC<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p>Let's compare that with the initial code:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>conditionA <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>conditionB <span class=\"token operator\">||</span> conditionC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p>Thanks to De Morgan's laws, we didn't even have to understand the initial logic to refactor it and make it cleaner.</p>\n",
      "date_published": "2020-07-04T00:00:00Z"
    },{
      "id": "https://blog.mauriciorobayo.com/posts/10x-your-code-with-the-facade-pattern-currying-and-closures/",
      "url": "https://blog.mauriciorobayo.com/posts/10x-your-code-with-the-facade-pattern-currying-and-closures/",
      "title": "10x your code with the facade pattern, currying, and closures",
      "content_html": "<p>Doing fetch requests is one of the most frequent tasks as a front-end JavaScript developer. If you are doing different fetch calls to different services on the same project, you might benefit from the <a href=\"http://jargon.js.org/_glossary/FACADE_PATTERN.md\">facade pattern</a>, <a href=\"https://javascript.info/currying-partials\">currying</a>, and <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures\">closures</a>.</p>\n<h2 id=\"the-setup\" tabindex=\"-1\">The Setup <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/10x-your-code-with-the-facade-pattern-currying-and-closures/#the-setup\" aria-hidden=\"true\">#</a></h2>\n<p>We won't worry about error handling or edge cases as this is going to be just an example to illustrate the main point of this article.</p>\n<p>Let's assume we are going to build a Weather App and we want to fetch the data from the <a href=\"https://openweathermap.org/api\">Open Weather API</a>. We might use something like this in our code:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchWeather</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">city</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> endpoint <span class=\"token operator\">=</span> <span class=\"token string\">\"https://api.openweathermap.org/data/2.5/weather\"</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> querystring <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">q=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;appid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">WEATHER_API_KEY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endpoint<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>querystring<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>statusText<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>status<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token punctuation\">}</span><br />  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">init</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> weatherData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchWeather</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"barranquilla\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>weatherData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<h2 id=\"the-facade-pattern\" tabindex=\"-1\">The Facade Pattern <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/10x-your-code-with-the-facade-pattern-currying-and-closures/#the-facade-pattern\" aria-hidden=\"true\">#</a></h2>\n<p>This looks fine so far. But now let's say that we want to get the city based on the IP address of the client using the <a href=\"https://ipinfo.io/\">ipinfo API</a>, so we might be tempted to create another fetch function for that:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchIpinfo</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> endpoint <span class=\"token operator\">=</span> <span class=\"token string\">\"https://ipinfo.io\"</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> querystring <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">token=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">IPINFO_TOKEN</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endpoint<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>querystring<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>statusText<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>status<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token punctuation\">}</span><br />  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchWeather</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">city</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> endpoint <span class=\"token operator\">=</span> <span class=\"token string\">\"https://api.openweathermap.org/data/2.5/weather\"</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> querystring <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">q=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;appid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">WEATHER_API_KEY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endpoint<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>querystring<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>statusText<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>status<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token punctuation\">}</span><br />  <span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">return</span> json<span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">init</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> city<span class=\"token punctuation\">,</span> country <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchIpinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> weatherData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchWeather</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>country<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>weatherData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>By now you should have noticed that there is a big issue here: we are repeating ourselves while using the <code>fetch</code> web API. It is almost the same code on both the <code>fetchWeather</code> and the <code>fetchIpinfo</code> functions.</p>\n<p>We know how to solve this. Let's refactor by moving the duplicate code into its own function which we will call <code>fetchData</code> so we can reuse it for both cases or any other that could come up:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">endpoint<span class=\"token punctuation\">,</span> querystring</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endpoint<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>querystring<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>statusText<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>status<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token punctuation\">}</span><br />  <span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">return</span> json<span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchWeather</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">city</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> endpoint <span class=\"token operator\">=</span> <span class=\"token string\">\"https://api.openweathermap.org/data/2.5/weather\"</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> querystring <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">q=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;appid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">WEATHER_API_KEY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">return</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span>endpoint<span class=\"token punctuation\">,</span> querystring<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchIpinfo</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> endpoint <span class=\"token operator\">=</span> <span class=\"token string\">\"https://ipinfo.io\"</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> querystring <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">token=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">IPINFO_TOKEN</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">return</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span>endpoint<span class=\"token punctuation\">,</span> querystring<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">init</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> city<span class=\"token punctuation\">,</span> country <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchIpinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> weatherData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchWeather</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>country<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>weatherData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>There we go. Basically, we are providing a simplified interface to the <code>fetch</code> web API, and we have successfully implemented the <a href=\"http://jargon.js.org/_glossary/FACADE_PATTERN.md\">facade pattern</a> to improve our code. That's all there is to it, we are mastering OOP design patterns 😄.</p>\n<h2 id=\"currying\" tabindex=\"-1\">Currying <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/10x-your-code-with-the-facade-pattern-currying-and-closures/#currying\" aria-hidden=\"true\">#</a></h2>\n<p>But still, something doesn't seem right with the code. The <code>fetchWeather</code> and the <code>fetchIpinfo</code> functions are very similar. It's time for some <a href=\"https://javascript.info/currying-partials\">currying</a>.</p>\n<p>We can remove the first argument of our <code>fetchData</code> function and make it return a new function based on that, so we can create as many <code>fetch*</code> functions as we need based on the endpoint provided:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchData</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">endpoint</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">querystring</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endpoint<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>querystring<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>statusText<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>status<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token punctuation\">}</span><br />  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">init</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> fetchIpinfo <span class=\"token operator\">=</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://ipinfo.io\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> fetchWeather <span class=\"token operator\">=</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><br />    <span class=\"token string\">\"https://api.openweathermap.org/data/2.5/weather\"</span><br />  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><br />  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> city<span class=\"token punctuation\">,</span> country <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchIpinfo</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">token=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">IPINFO_TOKEN</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> weatherData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchWeather</span><span class=\"token punctuation\">(</span><br />    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">q=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>country<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;appid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">WEATHER_API_KEY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><br />  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>weatherData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Dam! That code is looking sexy! We have successfully removed a lot of the duplicate code using the <a href=\"http://jargon.js.org/_glossary/FACADE_PATTERN.md\">facade pattern</a>, and we are reducing the <a href=\"https://en.wikipedia.org/wiki/Arity\">arity</a> of our <code>fetchData</code> function by <a href=\"https://javascript.info/currying-partials\">currying</a> it and making it return a new function depending on the <code>endpoint</code> that we are going to use.</p>\n<h2 id=\"closures\" tabindex=\"-1\">Closures <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/10x-your-code-with-the-facade-pattern-currying-and-closures/#closures\" aria-hidden=\"true\">#</a></h2>\n<p>Code is looking good, but now let's say we want to implement a cache to avoid doing repeated calls to the API services as the information is not likely to change between a few minutes.</p>\n<p>What's more, the Open Weather API suggests making calls to the service <a href=\"https://openweathermap.org/appid#use\">no more than once every 10 minutes</a> because the information is not updated more than that.</p>\n<blockquote>\n<p>We recommend making calls to the API no more than one time every 10 minutes for one location (city / coordinates / zip-code). This is due to the fact that weather data in our system is updated no more than one time every 10 minutes.</p>\n</blockquote>\n<p>Also, we won't need to be calling the <code>ipinfo</code> API very often because is not probable that we are going to change the city we are located between a few minutes.</p>\n<p>Maybe we can store the data we have previously fetched using <code>localStorage</code> and set an expire time to get the information from there.</p>\n<p>We can use 10 minutes expire time for the Open Weather API <code>localStorage</code> cache, and a longer cache time for the ipinfo API, for example, 30 minutes. That way we are lowering the requests made to the services decreasing the use of our requests quota, without affecting the accuracy of our app.</p>\n<p>To do that, we can take advantage of the closure we have created when <a href=\"https://javascript.info/currying-partials\">currying</a> the <code>fetchData</code> function, passing an object literal with the endpoint and the expiration time in minutes for the cache:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fromCache</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> cacheInMinutes</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> cacheInMilliseconds <span class=\"token operator\">=</span> cacheInMinutes <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>localStorage<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />    <span class=\"token keyword\">const</span> cache <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>localStorage<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> cache<span class=\"token punctuation\">.</span>datetime <span class=\"token operator\">&lt;</span> cacheInMilliseconds<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>cache<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> cache<span class=\"token punctuation\">.</span>datetime <span class=\"token operator\">+</span> cacheInMilliseconds <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br />    <span class=\"token punctuation\">}</span><br />    localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">removeItem</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token punctuation\">}</span><br />  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchData</span> <span class=\"token operator\">=</span><br />  <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> endpoint<span class=\"token punctuation\">,</span> cacheInMinutes <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span><br />  <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">querystring</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endpoint<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>querystring<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span><br />    <span class=\"token keyword\">const</span> cache <span class=\"token operator\">=</span> <span class=\"token function\">fromCache</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> cacheInMinutes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cache<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />      <span class=\"token keyword\">return</span> cache<span class=\"token punctuation\">;</span><br />    <span class=\"token punctuation\">}</span><br />    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br />      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>statusText<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>response<span class=\"token punctuation\">.</span>status<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />    <span class=\"token punctuation\">}</span><br />    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />    localStorage<span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">datetime</span><span class=\"token operator\">:</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> data <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>data<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br />  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">init</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><br />  <span class=\"token keyword\">const</span> fetchIpinfo <span class=\"token operator\">=</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><br />    <span class=\"token literal-property property\">endpoint</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://ipinfo.io\"</span><span class=\"token punctuation\">,</span><br />    <span class=\"token literal-property property\">cacheInMinutes</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span><br />  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> fetchWeather <span class=\"token operator\">=</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><br />    <span class=\"token literal-property property\">endpoint</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://api.openweathermap.org/data/2.5/weather\"</span><span class=\"token punctuation\">,</span><br />    <span class=\"token literal-property property\">cacheInMinutes</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span><br />  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><br />  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> city<span class=\"token punctuation\">,</span> country <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchIpinfo</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">token=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">IPINFO_TOKEN</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  <span class=\"token keyword\">const</span> weatherData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchWeather</span><span class=\"token punctuation\">(</span><br />    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">q=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>country<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;appid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">WEATHER_API_KEY</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><br />  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br />  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>weatherData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Take a look at that <code>init</code> function, isn't it expressive? We have written some clean and maintainable code using the <a href=\"http://jargon.js.org/_glossary/FACADE_PATTERN.md\">facade pattern</a>, <a href=\"https://javascript.info/currying-partials\">currying</a>, and <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures\">closures</a>. Now we can create as many <code>fetch*</code> functions as we want and we can give an expiration time in minutes for the <code>localStorage</code> cache for each of those functions.</p>\n<h2 id=\"conclusion\" tabindex=\"-1\">Conclusion <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/10x-your-code-with-the-facade-pattern-currying-and-closures/#conclusion\" aria-hidden=\"true\">#</a></h2>\n<p>This is not <em>the solution</em> neither the <em>way to do it</em>. This is just an example of some code refactoring during the constant commitment to writing self-documented, clean, and maintainable code.</p>\n<p>Some programming concepts seem like they are just concepts, with no real-life application. While we are looking to improve our code and make it clean and maintainable we might come up with a better implementation without even knowing the name of the pattern we are using. Or sometimes we just have a sense that something is not looking right, and looking for a way to do it better should be our daily battle.</p>\n",
      "date_published": "2020-02-18T00:00:00Z"
    },{
      "id": "https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/",
      "url": "https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/",
      "title": "How to hide your front-end API keys",
      "content_html": "<p>Most of web API services require the use of an API key or an access token to get authorization. The problem with this setup is that when you include your credentials with your front-end code, any user who understands the basics of HTTP and knows how to open developer tools can access them and use it for their own benefit.</p>\n<p><img src=\"https://blog.mauriciorobayo.com/img/dev-tools-exposing-API-key.png\" alt=\"dev tools exposing API key\" /></p>\n<h2 id=\"api-authorization\" tabindex=\"-1\">API Authorization <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#api-authorization\" aria-hidden=\"true\">#</a></h2>\n<p>When you make the request to the API service you need to include your credentials to let the service know that you are an authorized user. To do this you will be asked to include them on the query string or as a header when you make the request.</p>\n<p>If you fail to include them in the request you will not be associated with an authorized user and the API service will return an error indicating that your app isn't authorized to request the data.</p>\n<p>If you successfully included the credentials and if you are still below any quota or limit on your account, the service sends an OK response with the requested data.</p>\n<h2 id=\"the-problem\" tabindex=\"-1\">The Problem <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#the-problem\" aria-hidden=\"true\">#</a></h2>\n<p>Leaking your credentials becomes a major issue because anyone with your API key or authorization token will be able to make requests to the API service on your behalf, and those requests will count as yours. This means that if you are on a paid plan for the service, you will end up paying requests someone else is making on your behalf.</p>\n<p>Additionally, if someone else uses your credentials outside the terms of service of the API provider or includes them in an app that is used for non-legal activities, you will be held responsible because the API provider will think you are the one making those requests. In the best-case scenario, your credentials will be revoked.</p>\n<h2 id=\"the-solution\" tabindex=\"-1\">The Solution <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#the-solution\" aria-hidden=\"true\">#</a></h2>\n<p>Since you need to include your authorization token on every request made to the API service and there is no way around this, we need to find a way to make the request to the API service including your credentials but at the same time removing them from your web app so they are not exposed on the front-end.</p>\n<p>This is where a proxy comes into place.</p>\n<p>Think of a proxy as a middleman. You will send the request to that middleman who will make some changes to the request and forward it to the API service. When the API service responds, the middleman will forward that response back to you.</p>\n<p>That way you can remove your credentials from the front-end code by sending the request to the proxy, which will add your authorization method and forward it to the API service and back to you once it gets a response.</p>\n<p>You will also tell the middleman to only respond to you. The middleman will be able to filter the requests by the domain they come from, using the origin header which is set by the browser once the request is made.</p>\n<p>So basically, you are going to tell the middleman to only allow some domains to interact with it. If the request comes from your domain, it's going to be allowed by the middleman and proxied to the API service with the appropriate credentials, and then forward the response back to you. If the domain making the request is not allowed, then the middleman is just going to block that request.</p>\n<p>During this process, your web app is completely unaware of your credentials, hence nobody is going to be able to get them.</p>\n<p>Note that some API services require you to associate your credentials with one or more domains. The service will check your API key and the domain the request comes from and will authorize the request only when the origin was allowed by the user holding the credentials.</p>\n<p>In those cases, there is no need for a proxy server because even if the credentials are visible, nobody is going to be able to make a request with those credentials from a domain that was not authorized by the user.</p>\n<p>In some other cases, other API services enforce restrictions that don't allow them to be called directly from the client, so a proxy server is required to be able to handle the requests on behalf of the client.</p>\n<h2 id=\"setting-your-proxy-server\" tabindex=\"-1\">Setting your proxy server <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#setting-your-proxy-server\" aria-hidden=\"true\">#</a></h2>\n<p>Since the proxy is nothing more than a server that is forwarding requests, you can very easily deploy your own proxy server using any cloud provider.</p>\n<p>You can set up a simple Node.js server using Express.js and the <a href=\"https://github.com/chimurai/http-proxy-middleware\">http-proxy-middleware</a> package, and deploy it to Heroku or any other cloud provider.</p>\n<p>If you decide to use Heroku you can store your credentials as config vars. That way, they will be safely hidden and the proxy will add them on each request it forwards to the API service. Your front-end app won't know anything about your credentials, that's the job of the middleman.</p>\n<p>Once your proxy server is up and running, you can then redirect the requests on your front-end code to target it. It will safely add your credentials and forward the request to the API service, and once it gets the response from the API service it will forward it back to your app.</p>\n<h2 id=\"ok-show-me-the-code\" tabindex=\"-1\">OK, show me the code <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#ok-show-me-the-code\" aria-hidden=\"true\">#</a></h2>\n<p>To get your proxy server up and running on Heroku you can use the <a href=\"https://github.com/MauricioRobayo/api-key-proxy-server\">api-key-proxy-server</a> repository that has everything setup.</p>\n<h3 id=\"1.-clone-the-repository\" tabindex=\"-1\">1. Clone the repository <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#1.-clone-the-repository\" aria-hidden=\"true\">#</a></h3>\n<pre><code>git clone https://github.com/MauricioRobayo/api-key-proxy-heroku.git\n</code></pre>\n<h3 id=\"2.-move-into-the-repository-and-create-a-new-heroku-app\" tabindex=\"-1\">2. Move into the repository and create a new Heroku app <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#2.-move-into-the-repository-and-create-a-new-heroku-app\" aria-hidden=\"true\">#</a></h3>\n<pre><code>cd api-key-proxy-heroku\nheroku create\n</code></pre>\n<h3 id=\"3.-include-your-api-keys\" tabindex=\"-1\">3. Include your API keys <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#3.-include-your-api-keys\" aria-hidden=\"true\">#</a></h3>\n<p>Include your API keys on the Heroku app. On the dashboard go to Settings and lookup for the Config Vars section. Copy and paste your API keys there using the same variable name you are using to retrieve it as an environment variable on each proxy service on the <a href=\"https://github.com/MauricioRobayo/api-key-proxy-server/blob/master/src/config.js\">config file</a>. For example, in the case of the <a href=\"https://github.com/MauricioRobayo/api-key-proxy-server/blob/502806c8b5af5c95a135d88e9a5193ebdd6532b8/src/config.js#L12\">Open Weather API proxy configuration</a> that is included with the code, the variable name is <code>WEATHER_API_KEY</code>.</p>\n<h3 id=\"4.-set-up-your-api-proxies\" tabindex=\"-1\">4. Set up your API proxies <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#4.-set-up-your-api-proxies\" aria-hidden=\"true\">#</a></h3>\n<p>You can include all the API services you want using the <a href=\"https://github.com/MauricioRobayo/api-key-proxy-server/blob/master/src/config.js\">config file</a> which exports an object with two options: <strong>allowedDomains</strong> and <strong>proxies</strong>.</p>\n<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token literal-property property\">allowedDomains</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'https://www.example.com'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><br />  <span class=\"token literal-property property\">proxies</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token comment\">// We will handle this in a second ],</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p><strong>allowedDomains</strong>: An array of domains you want to allow to make calls to the proxy server. All the domains not listed here will be rejected with a CORS error.</p>\n<p>Do not include pathnames:</p>\n<ul>\n<li>Wrong: <code>https://example.com/some-path</code> ❌</li>\n<li>Right: <code>https://example.com</code> ✔</li>\n</ul>\n<p>Do not include trailing slash:</p>\n<ul>\n<li>Wrong: <code>https://example.com/</code> ❌</li>\n<li>Right: <code>https://example.com</code> ✔</li>\n</ul>\n<p><strong>proxies</strong>: An array with the configuration options for each API service. The <a href=\"https://github.com/MauricioRobayo/api-key-proxy-server/blob/master/src/config.js\">config file</a> included provides configurations for the <a href=\"https://openweathermap.org/api\">Open Weather API</a>, the <a href=\"https://ipinfo.io/\">ipinfo API</a>, and the <a href=\"https://developer.github.com/v3/\">GitHub API</a>. You can remove or add as many as you need:</p>\n<pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><br />  <span class=\"token literal-property property\">allowedDomains</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://www.example.com\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><br />  <span class=\"token literal-property property\">proxies</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><br />    <span class=\"token punctuation\">{</span><br />      <span class=\"token literal-property property\">route</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/weather\"</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">allowedMethods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">target</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://api.openweathermap.org/data/2.5/weather\"</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">queryparams</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><br />        <span class=\"token literal-property property\">appid</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">WEATHER_API_KEY</span><span class=\"token punctuation\">,</span><br />      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br />    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br />    <span class=\"token punctuation\">{</span><br />      <span class=\"token literal-property property\">route</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/ipinfo\"</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">allowedMethods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">target</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://ipinfo.io/\"</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">queryparams</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><br />        <span class=\"token literal-property property\">token</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">IPINFO_TOKEN</span><span class=\"token punctuation\">,</span><br />      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br />    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br />    <span class=\"token punctuation\">{</span><br />      <span class=\"token literal-property property\">route</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/github\"</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">allowedMethods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">target</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://api.github.com\"</span><span class=\"token punctuation\">,</span><br />      <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><br />        <span class=\"token literal-property property\">Accept</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application/vnd.github.v3+json\"</span><span class=\"token punctuation\">,</span><br />        <span class=\"token literal-property property\">Authorization</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Token </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">GITHUB_TOKEN</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span><br />      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br />    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br />  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><br /><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Let's take a look at a proxy configuration from the above, it's an object that looks like this:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span><br />  <span class=\"token literal-property property\">route</span><span class=\"token operator\">:</span> <span class=\"token string\">'/weather'</span><span class=\"token punctuation\">,</span><br />  <span class=\"token literal-property property\">allowedMethods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><br />  <span class=\"token literal-property property\">target</span><span class=\"token operator\">:</span> <span class=\"token string\">'https://api.openweathermap.org/data/2.5/weather'</span><span class=\"token punctuation\">,</span><br />  <span class=\"token literal-property property\">queryparams</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><br />    <span class=\"token literal-property property\">appid</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">WEATHER_API_KEY</span><span class=\"token punctuation\">,</span><br />  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br /><span class=\"token punctuation\">}</span></code></pre>\n<p>The <strong>route</strong> is the path where your API proxy is going to listen for your requests. If you are using Heroku, you could reach your weather API proxy using the <code>weather</code> path on your Heroku app:</p>\n<pre class=\"language-http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">https</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//your-proxy-server.heroku.app/weather</span></span></code></pre>\n<p>The <strong>allowedMethods</strong> is an array of HTTP methods the server will proxy to the API service. It defaults to <code>GET</code> if omitted. For this example, we are explicitly setting it to <code>GET</code> as that's the only type of request we are going to do to the API.</p>\n<p>The <strong>target</strong> is the API endpoint that the proxy server is going to forward requests to. All requests made to the <code>route</code> on the proxy server will be proxied to the <code>target</code> endpoint.</p>\n<p>The <strong>queryparams</strong> is an object with additional query params to be added to the request that the proxy makes to the <code>target</code> endpoint. Since the <a href=\"https://openweathermap.org/appid#use\">authorization by the Open Weather API</a> is done by means of a query parameter, we include it here. Notice that the API key is going to be read from the environment variables that you set on the <code>Config Vars</code> section on Heroku and it's called <code>WEATHER_API_KEY</code>:</p>\n<p><img src=\"https://blog.mauriciorobayo.com/img/heroku-env-vars.png\" alt=\"Heroku env vars\" /></p>\n<p>For the Open Weather API, that's all you need. But there are some other options supported if you need more:</p>\n<ul>\n<li><strong>allowedDomains</strong>: You can include specific allowed domains for a single proxy.</li>\n<li><strong>headers</strong>: An object with the headers that will be added to the request made to the proxy server.</li>\n<li><strong>auth</strong>: Basic authentication, for example: <code>user:password</code> to compute an Authorization header.</li>\n</ul>\n<h3 id=\"5.-commit-your-changes-and-deploy-to-heroku\" tabindex=\"-1\">5. Commit your changes and deploy to Heroku <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#5.-commit-your-changes-and-deploy-to-heroku\" aria-hidden=\"true\">#</a></h3>\n<pre><code>git commit -am&quot;Update proxy settings&quot;\ngit push heroku\n</code></pre>\n<p>Finally, you can use your Proxy server to redirect the requests from your front-end code. Notice that you do not need to include any authorization key or token on the request to the proxy.</p>\n<p>Request including authorization key 😢:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> apiService <span class=\"token operator\">=</span> <span class=\"token string\">\"https://api.openweathermap.org/data/2.5/weather\"</span><span class=\"token punctuation\">;</span><br /><br /><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>apiService<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?q=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;units=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>units<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;appid=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>apiKey<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><br />  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br />  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">json</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleData</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Request to the proxy without authorization key 😊:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> apiProxy <span class=\"token operator\">=</span> <span class=\"token string\">'https://your-proxy-server.herokuapp.com/weather'</span><br /><br /><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>apiProxy<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?q=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;units=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>units<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><br />  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br />  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">json</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleData</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span></code></pre>\n<p>If you want to test drive the proxy server without deploying to Heroku or any other cloud provider, you can check the section <a href=\"https://github.com/MauricioRobayo/api-key-proxy-server#test-it-on-development\">test it on development</a> of the documentation.</p>\n<p>You can also check this weather app and its code which is using the proxy server.</p>\n<h2 id=\"conclusion\" tabindex=\"-1\">Conclusion <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#conclusion\" aria-hidden=\"true\">#</a></h2>\n<p>Your credentials should be private and it is a bad practice to let them out there on the wild where anybody can pick them up and use them for their own purposes.</p>\n<p>When deploying a front-end app using a third-party API service that is not verifying the origin of the requests, make sure that you are using a proxy server to protect your identity from being stolen.</p>\n<p>If you have any app that you deployed including your private credentials, go ahead and deploy your proxy server using the one suggested here or by configuring your own. Once you do that, remove the credentials from your front-end code and don't forget to revoke them as they were already exposed.</p>\n<h2 id=\"acknowledgments\" tabindex=\"-1\">Acknowledgments <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/how-to-hide-your-front-end-api-keys/#acknowledgments\" aria-hidden=\"true\">#</a></h2>\n<p>Huge thanks to <a href=\"https://github.com/matheus-fls\">@matheus-fls</a> for the invaluable feedback provided to improve the code, and to <a href=\"https://github.com/majovanilla\">@majovanilla</a> for her massive contribution to make this article more readable.</p>\n",
      "date_published": "2020-02-12T00:00:00Z"
    },{
      "id": "https://blog.mauriciorobayo.com/posts/css-grid-is-a-grid-framework/",
      "url": "https://blog.mauriciorobayo.com/posts/css-grid-is-a-grid-framework/",
      "title": "CSS Grid IS a grid framework",
      "content_html": "<p>On October 10, 1994, <a href=\"https://www.w3.org/People/howcome/p/cascade.html\">Cascading Style Sheets (CSS) were proposed to style online documents</a>. But then the Internet exploded with web apps and devices, and CSS fell behind. It was not designed to layout complex user interfaces on multiple screen sizes.</p>\n<p>So, CSS frameworks came alive. And with a huge success, they did. A quick <a href=\"https://github.com/search?q=css+grid+framework\">search on Github for CSS grid frameworks</a> gives more than 500 repositories as a result.</p>\n<p>Bootstrap was <a href=\"https://www.quora.com/What-are-the-most-popular-GitHub-repositories-of-all-time/answer/Rachel-Berry-9\">the most starred project on Github for a long time</a>. Something was missing from CSS that made people reach out for frameworks as if their life depended on it.</p>\n<p><img src=\"https://blog.mauriciorobayo.com/img/css.gif\" alt=\"css\" /></p>\n<p>But a lot has changed since CSS was first implemented and <a href=\"http://grid-layout.com/history.html\">the layout of webpages was done with HTML tables</a>. CSS has been catching up with the new requirements of the web, and it has done it very well.</p>\n<p>Now we have <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/--*\">custom properties (CSS Variables)</a>, a bunch of <a href=\"https://www.w3schools.com/cssref/css_functions.asp\">CSS Functions</a>, and not only one, but two CSS modules for layout: Flexible Box Layout Module, and The Grid Layout Module.</p>\n<p>With Flexbox and especially with CSS Grid, a powerful way for designing user interfaces using just native CSS is available to us, filling the gap that made all the CSS grid frameworks came alive.</p>\n<p>There are a lot of tutorials and information on both and still, a lot of developers are investing more time in learning a Grid framework than in mastering the native layout tools now available with CSS.<br />\nSo, let’s see what they have to offer against a Grid Framework and why they should be your first choice on your path to becoming a master designing layouts.</p>\n<h2 id=\"the-flexible-box-layout-module\" tabindex=\"-1\">The Flexible Box Layout Module <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/css-grid-is-a-grid-framework/#the-flexible-box-layout-module\" aria-hidden=\"true\">#</a></h2>\n<p>The Flexible Box Layout Module provides an efficient way to layout, align and distribute items inside a container.</p>\n<p>A main characteristic of Flexbox is that it can work either horizontally or vertically, a huge advantage against regular layouts using <code>block</code> which is vertically based or <code>inline</code> which is horizontally based.</p>\n<p>This is the first line of the <a href=\"https://www.w3.org/TR/css-flexbox-1/\">Flexbox spec</a>:</p>\n<blockquote>\n<p>The specification describes a CSS box model <strong>optimized for user interface design</strong>.</p>\n</blockquote>\n<p>Since it was developed for designing user interfaces, building a grid system using FlexBox is straightforward, it might take you about <a href=\"https://www.youtube.com/watch?v=J4fAqATYEr0\">14 minutes to understand how to do it</a>, and less than five to do it yourself:</p>\n<p>It is so powerful that even Bootstrap 4 is using Flexbox behind the scenes. <a href=\"https://blog.getbootstrap.com/2017/01/06/bootstrap-4-alpha-6/\">This is their announcement</a> from January 2017:</p>\n<blockquote>\n<p>Bootstrap 4 is now flexbox by default! Flexbox is an immensely powerful layout tool, providing unparalleled flexibility and control to our grid system and core components.</p>\n</blockquote>\n<p>If you want to deep dive into Flexbox, I couldn’t recommend enough the <a href=\"https://www.youtube.com/playlist?list=PLu8EoSxDXHP7xj_y6NIAhy0wuCd4uVdid\">What The Flexbox?!</a> course by Wes Bos available for free on YouTube.</p>\n<p>The Net Ninja also has a free and very <a href=\"https://www.youtube.com/playlist?list=PL4cUxeGkcC9i3FXJSUfmsNOx8E7u6UuhG\">in-depth Flexbox</a> course worth watching.</p>\n<p>You should also keep at hand the visual guide on CSS Tricks as a reference when working with Flexbox: <a href=\"https://css-tricks.com/snippets/css/a-guide-to-flexbox/\">A complete guide to Flexbox</a>.</p>\n<h2 id=\"css-grid-layout-module\" tabindex=\"-1\">CSS Grid Layout Module <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/css-grid-is-a-grid-framework/#css-grid-layout-module\" aria-hidden=\"true\">#</a></h2>\n<p>While Flexbox is largely a one-dimensional system, with CSS Grid we have a two-dimensional native CSS layout system for the web, which allows us to easily recreate framework-based grids using just a few lines of CSS. This is the first line of the <a href=\"https://www.w3.org/TR/css-grid-1/\">CSS Grid</a> spec:</p>\n<blockquote>\n<p>This CSS module defines a two-dimensional grid-based layout system, <strong>optimized for user interface design</strong>.</p>\n</blockquote>\n<p>Although CSS Grid is gaining popularity it is still not widely used, less than 5% of the sites are using it according to the <a href=\"https://www.chromestatus.com/metrics/css/popularity\">Chrome Platform Status</a>.</p>\n<p>Flexbox is more popular at this time and is <a href=\"https://caniuse.com/#feat=flexbox\">fully supported by all browsers</a>. CSS Grid is <a href=\"https://caniuse.com/#feat=css-grid\">almost there</a>.</p>\n<p>And of course, <a href=\"https://github.com/twbs/bootstrap/issues/24887\">Bootstrap 5 is already planning to use CSS Grid</a>. So yeah, <a href=\"https://twitter.com/g16n/status/782607880377733120\">build it and they will come</a>.</p>\n<p>A better solution for Bootstrap might be to drop the twelve column grid system as proposed by <a href=\"https://github.com/twbs/bootstrap/issues/24887#issuecomment-407360456\">Muhammad Rehan Saeed</a>:</p>\n<blockquote>\n<p>I’m trying to understand if the twelve column grid makes sense anymore to layout a page. The twelve column grid can only use a subset of the features of CSS Grid, without some utility classes added on to help and even then I’m not sure. If using React/Vue or some other framework, perhaps it’s time to dump the twelve column grid and use raw CSS Grid instead. If you did that, you no longer have to use HTML div’s to layout your page. What are your thoughts?</p>\n</blockquote>\n<p>Probably the best place to start and get a good understanding of CSS Grid is <a href=\"https://gridbyexample.com/\">the Grid by Example</a> website by Rachel Andrew, a member of the <a href=\"https://www.w3.org/Style/CSS/members/members.en.php3\">CSS Working Group</a>. You could also <a href=\"https://www.youtube.com/results?search_query=Rachel+Andrew\">search YouTube for the many talks she has given on CSS Grid</a> and related topics, you probably won’t regret it.</p>\n<p>Again, both Wes Bos and the Net Ninja have very thorough and professional free courses on CSS Grid worth the time:</p>\n<ul>\n<li><a href=\"https://www.youtube.com/playlist?list=PLu8EoSxDXHP5CIFvt9-ze3IngcdAc2xKG\">Wes Box CSS Grid</a>.</li>\n<li><a href=\"https://www.youtube.com/playlist?list=PL4cUxeGkcC9itC4TxYMzFCfveyutyPOCY\">The Net Ninja CSS Grid Tutorial</a>.</li>\n</ul>\n<p>And if you are short of time and only want to visit one resource, this should be it: <a href=\"https://labs.jensimmons.com/\">Jen Simmons Lab</a>, by Jen Simmons. She is also a member of the CSS Working Group and one of the brilliant minds behind the coming revolution in graphic design on the web, so if this topic matters to you, you should listen to what she has to say.</p>\n<p>Just scroll down her page to take a look at the amazing power of CSS Grid, and also be sure to check her YouTube channel <a href=\"https://www.youtube.com/channel/UC7TizprGknbDalbHplROtag\">Layout Land</a>.</p>\n<h2 id=\"conclusion\" tabindex=\"-1\">Conclusion <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/css-grid-is-a-grid-framework/#conclusion\" aria-hidden=\"true\">#</a></h2>\n<p>Now that CSS Grid is gaining traction, everyone is asking if we should replace grid framework layouts with CSS Grid. And almost every answer is that doing so is a huge win.</p>\n<p>Dan Brown demonstrated how simple and efficient it is to replace a Bootstrap layout with CSS Grid in <a href=\"https://hacks.mozilla.org/2017/04/replace-bootstrap-layouts-with-css-grid/\">this insightful article</a>, but warns us about using CSS Grid to recreate the Bootstrap Grid Framework, as we are restricting it of many of its real capabilities by doing so:</p>\n<blockquote>\n<p>We don’t want to limit CSS Grid by shoehorning it into a syntax that will limit its potential. We were able to easily recreate the Bootstrap grid, but CSS Grid is so much more powerful than any grid system that came before it. That’s because it is a web-native solution built from the ground up.</p>\n</blockquote>\n<p>Also, you can watch <a href=\"https://www.youtube.com/watch?v=bXeeMuKI2YM\">this video</a> showing the benefits of rewriting a Bootstrap grid layout with CSS Grid.</p>\n<p>As you can see, regarding file size, the Bootstrap version is <strong>58 times larger than the native CSS</strong> one. Even after running the Bootstrap version over <a href=\"https://www.purgecss.com/\">PurgeCSS</a> the Bootstrap version is 3.4 times larger!</p>\n<p>And that’s just regarding file sizes without taking into account that you are being restrained by the Bootstrap twelve columns grid system, and you should also consider the huge semantic gain by not having to rely on additional HTML markup just for layout purposes, like a div inside another div inside another div, etc. That’s not what markup is for, that’s what CSS is for.</p>\n<p><img src=\"https://blog.mauriciorobayo.com/img/css-grid-vs-bootstrap.jpeg\" alt=\"CSS grid vs Bootstrap\" /></p>\n<p>So the question might be if grid frameworks are still relevant when we have CSS Grid. Probably, the answer is no.</p>\n<p>But there might be still some time before developers drop the use of grid frameworks as they are too used to them.</p>\n<p>Morten Rand-Hendriksen couldn’t say it better on his <a href=\"https://www.youtube.com/watch?v=txZq7Laz7_4&amp;feature=youtu.be&amp;t=2555\">great introductory talk to CSS Grid</a>:</p>\n<blockquote>\n<p>It’s interesting to think about where these frameworks will go next because the frameworks are very much rooted in this idea of using divs and containers to create these advanced layouts and with CSS grid a lot of that goes away. So if the frameworks were to migrate to CSS Grid they would have to break their standard practice and retrain all the people who use it. That might mean that these frameworks will date themselves out of the game.</p>\n</blockquote>\n<p>And Rachel Andrew predicted all of this when <a href=\"https://youtu.be/N5Lt1SLqBmQ?t=1775\">presenting the CSS Grid framework</a> in February 2017:</p>\n<blockquote>\n<p>And the thing is what is going to happen? And I guarantee you what is going to happen is that just like Flexbox we are going to see everybody posting their grid layout based grid frameworks to GitHub. But please, if you think of doing that, think about whether that abstraction actually adds anything or whether it just adds a sort of weird layer of complexity on top of something because a lot the time we’re not gonna need a grid layout based grid framework because grid is a grid framework built right into CSS.</p>\n</blockquote>\n<p>So, the next time you are thinking about using a grid framework like the one provided by Bootstrap to layout your website, think twice. You might be adding extra complexity and losing flexibility. You might be better just learning Flexbox and CSS Grid inside-out.</p>\n<p>And if you are thinking about writing the next grid framework, remember that CSS Grid <strong>is</strong> a grid framework.</p>\n<h2 id=\"additional-resources\" tabindex=\"-1\">Additional resources <a class=\"direct-link\" href=\"https://blog.mauriciorobayo.com/posts/css-grid-is-a-grid-framework/#additional-resources\" aria-hidden=\"true\">#</a></h2>\n<ul>\n<li><a href=\"https://www.youtube.com/watch?v=3LxyRuZxs2w\">The state of CSS</a>.</li>\n<li><a href=\"https://www.youtube.com/watch?v=TQ7NqpFMbFs\">CSS Standardization</a>.</li>\n<li><a href=\"https://www.w3.org/Style/CSS20/history.html\">A brief history of CSS until 2016</a>.</li>\n</ul>\n<hr />\n<p><strong>PS</strong>: This is not about CSS frameworks in general, they are still <a href=\"https://www.youtube.com/watch?v=RYmVqGxkCXE\">very useful in many circumstances</a>, including Bootstrap. This is about CSS grid frameworks, like the twelve column grid system included with Bootstrap, and that’s just a part of what Bootstrap offers.</p>\n",
      "date_published": "2019-11-11T00:00:00Z"
    }
  ]
}
